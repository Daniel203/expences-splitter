PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;

    DROP TABLE IF NOT EXISTS "users";

    CREATE TABLE IF NOT EXISTS "users" (
            id INTEGER PRIMARY KEY,
            username TEXT NOT NULL UNIQUE,
            password TEXT NOT NLL,
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        );

    INSERT INTO users VALUES(1,'user1', 'pass');
    INSERT INTO users VALUES(2,'user2', 'pass');
    INSERT INTO users VALUES(3,'user3', 'pass');


    DROP TABLE IF EXISTS "rooms";

    CREATE TABLE rooms (
            id INTEGER PRIMARY KEY,
            room_name TEXT NOT NULL,
            max_participants INTEGER NOT NULL,
            owner INTEGER NOT NULL,
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
            FOREIGN KEY (owner) REFERENCES "users"(id)
        );

    INSERT INTO rooms VALUES(1,'Room 1',5,1);
    INSERT INTO rooms VALUES(2,'Room 2',3,2);
    INSERT INTO rooms VALUES(3,'Room 3',4,3);

    CREATE TABLE _sqlx_migrations (
        version BIGINT PRIMARY KEY,
        description TEXT NOT NULL,
        installed_on TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
        success BOOLEAN NOT NULL,
        checksum BLOB NOT NULL,
        execution_time BIGINT NOT NULL
    );

COMMIT;
